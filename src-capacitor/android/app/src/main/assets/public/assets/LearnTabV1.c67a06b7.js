import{c as s,at as Bt,au as ue,k as it,r as M,m as K,h as v,ak as be,v as Ht,g as dt,av as Rt,I as ie,E as L,aw as Tt,ax as lt,ay as Et,az as Ft,aA as Oe,aB as Nt,a as Ot,o as At,y as C,a6 as T,a3 as Z,aC as jt,a7 as Ye,a8 as Ie,w as Lt,aD as Qt,a4 as G,V as zt,X as Pt,f as Ut,a0 as je,z as de,B as x,a9 as Ve,a5 as W,C as _,Q as Wt,D as Q,aE as Kt,aF as Jt,q as Xt,n as Gt,aa as F}from"./index.904fb14a.js";import{Q as pe,a as se,c as we,d as Zt,b as ea}from"./QDialog.2982e651.js";import{u as ta,e as aa,f as la,Q as nt}from"./QCardSection.b9a121b1.js";import{u as ct,a as vt}from"./use-dark.33053ea6.js";import{Q as mt}from"./QCardActions.d2332bc6.js";import{Q as Le}from"./QCard.5c7dff5f.js";import{Q as na}from"./QPage.91e185e6.js";import{u as oa}from"./uid.42677368.js";import"./use-timeout.a1378caa.js";import"./scroll.8ba91029.js";function ra(){const a=new Map;return{getCache:function(w,r){return a[w]===void 0?a[w]=r:a[w]},getCacheWithFn:function(w,r){return a[w]===void 0?a[w]=r():a[w]}}}const sa=["gregorian","persian"],ua={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:a=>sa.includes(a),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},ia=["update:modelValue"];function ae(a){return a.year+"/"+ue(a.month)+"/"+ue(a.day)}function da(a,w){const r=s(()=>a.disable!==!0&&a.readonly!==!0),h=s(()=>r.value===!0?0:-1),y=s(()=>{const p=[];return a.color!==void 0&&p.push(`bg-${a.color}`),a.textColor!==void 0&&p.push(`text-${a.textColor}`),p.join(" ")});function k(){return a.locale!==void 0?{...w.lang.date,...a.locale}:w.lang.date}function m(p){const I=new Date,H=p===!0?null:0;if(a.calendar==="persian"){const Y=Bt(I);return{year:Y.jy,month:Y.jm,day:Y.jd}}return{year:I.getFullYear(),month:I.getMonth()+1,day:I.getDate(),hour:H,minute:H,second:H,millisecond:H}}return{editable:r,tabindex:h,headerClass:y,getLocale:k,getCurrentDate:m}}const re=20,ca=["Calendar","Years","Months"],ot=a=>ca.includes(a),Ae=a=>/^-?[\d]+\/[0-1]\d$/.test(a),he=" \u2014 ";function le(a){return a.year+"/"+ue(a.month)}var rt=it({name:"QDate",props:{...ua,...ta,...ct,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Ae},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Ae},navigationMaxYearMonth:{type:String,validator:Ae},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:ot}},emits:[...ia,"rangeStart","rangeEnd","navigation"],setup(a,{slots:w,emit:r}){const{proxy:h}=dt(),{$q:y}=h,k=vt(a,y),{getCache:m}=ra(),{tabindex:p,headerClass:I,getLocale:H,getCurrentDate:Y}=da(a,y);let A;const P=aa(a),B=la(P),$=M(null),z=M(Je()),D=M(H()),Me=s(()=>Je()),$e=s(()=>H()),q=s(()=>Y()),d=M(Xe(z.value,D.value)),V=M(a.defaultView),ne=y.lang.rtl===!0?"right":"left",J=M(ne.value),ce=M(ne.value),ye=d.value.year,E=M(ye-ye%re-(ye<0?re:0)),R=M(null),Se=s(()=>{const e=a.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${a.minimal===!0?"minimal":"standard"}`+(k.value===!0?" q-date--dark q-dark":"")+(a.bordered===!0?" q-date--bordered":"")+(a.square===!0?" q-date--square no-border-radius":"")+(a.flat===!0?" q-date--flat no-shadow":"")+(a.disable===!0?" disabled":a.readonly===!0?" q-date--readonly":"")}),U=s(()=>a.color||"primary"),X=s(()=>a.textColor||"white"),ee=s(()=>a.emitImmediately===!0&&a.multiple!==!0&&a.range!==!0),ve=s(()=>Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue!==null&&a.modelValue!==void 0?[a.modelValue]:[]),u=s(()=>ve.value.filter(e=>typeof e=="string").map(e=>Re(e,z.value,D.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),c=s(()=>{const e=t=>Re(t,z.value,D.value);return ve.value.filter(t=>Tt(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),f=s(()=>a.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=lt(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),me=s(()=>a.calendar==="persian"?ae:(e,t,l)=>Et(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?z.value:t,l===void 0?D.value:l,e.year,e.timezoneOffset)),De=s(()=>u.value.length+c.value.reduce((e,t)=>e+1+Ft(f.value(t.to),f.value(t.from)),0)),Qe=s(()=>{if(a.title!==void 0&&a.title!==null&&a.title.length!==0)return a.title;if(R.value!==null){const l=R.value.init,o=f.value(l);return D.value.daysShort[o.getDay()]+", "+D.value.monthsShort[l.month-1]+" "+l.day+he+"?"}if(De.value===0)return he;if(De.value>1)return`${De.value} ${D.value.pluralDay}`;const e=u.value[0],t=f.value(e);return isNaN(t.valueOf())===!0?he:D.value.headerTitle!==void 0?D.value.headerTitle(t,e):D.value.daysShort[t.getDay()]+", "+D.value.monthsShort[e.month-1]+" "+e.day}),gt=s(()=>u.value.concat(c.value.map(t=>t.from)).sort((t,l)=>t.year-l.year||t.month-l.month)[0]),ht=s(()=>u.value.concat(c.value.map(t=>t.to)).sort((t,l)=>l.year-t.year||l.month-t.month)[0]),ze=s(()=>{if(a.subtitle!==void 0&&a.subtitle!==null&&a.subtitle.length!==0)return a.subtitle;if(De.value===0)return he;if(De.value>1){const e=gt.value,t=ht.value,l=D.value.monthsShort;return l[e.month-1]+(e.year!==t.year?" "+e.year+he+l[t.month-1]+" ":e.month!==t.month?he+l[t.month-1]:"")+" "+t.year}return u.value[0].year}),qe=s(()=>{const e=[y.iconSet.datetime.arrowLeft,y.iconSet.datetime.arrowRight];return y.lang.rtl===!0?e.reverse():e}),Pe=s(()=>a.firstDayOfWeek!==void 0?Number(a.firstDayOfWeek):D.value.firstDayOfWeek),yt=s(()=>{const e=D.value.daysShort,t=Pe.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),te=s(()=>{const e=d.value;return a.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Oe(e.year,e.month)}),Dt=s(()=>typeof a.eventColor=="function"?a.eventColor:()=>a.eventColor),N=s(()=>{if(a.navigationMinYearMonth===void 0)return null;const e=a.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),O=s(()=>{if(a.navigationMaxYearMonth===void 0)return null;const e=a.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),Be=s(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return N.value!==null&&N.value.year>=d.value.year&&(e.year.prev=!1,N.value.year===d.value.year&&N.value.month>=d.value.month&&(e.month.prev=!1)),O.value!==null&&O.value.year<=d.value.year&&(e.year.next=!1,O.value.year===d.value.year&&O.value.month<=d.value.month&&(e.month.next=!1)),e}),Ce=s(()=>{const e={};return u.value.forEach(t=>{const l=le(t);e[l]===void 0&&(e[l]=[]),e[l].push(t.day)}),e}),Ue=s(()=>{const e={};return c.value.forEach(t=>{const l=le(t.from),o=le(t.to);if(e[l]===void 0&&(e[l]=[]),e[l].push({from:t.from.day,to:l===o?t.to.day:void 0,range:t}),l<o){let n;const{year:b,month:i}=t.from,g=i<12?{year:b,month:i+1}:{year:b+1,month:1};for(;(n=le(g))<=o;)e[n]===void 0&&(e[n]=[]),e[n].push({from:void 0,to:n===o?t.to.day:void 0,range:t}),g.month++,g.month>12&&(g.year++,g.month=1)}}),e}),_e=s(()=>{if(R.value===null)return;const{init:e,initHash:t,final:l,finalHash:o}=R.value,[n,b]=t<=o?[e,l]:[l,e],i=le(n),g=le(b);if(i!==j.value&&g!==j.value)return;const S={};return i===j.value?(S.from=n.day,S.includeFrom=!0):S.from=1,g===j.value?(S.to=b.day,S.includeTo=!0):S.to=te.value,S}),j=s(()=>le(d.value)),_t=s(()=>{const e={};if(a.options===void 0){for(let l=1;l<=te.value;l++)e[l]=!0;return e}const t=typeof a.options=="function"?a.options:l=>a.options.includes(l);for(let l=1;l<=te.value;l++){const o=j.value+"/"+ue(l);e[l]=t(o)}return e}),xt=s(()=>{const e={};if(a.events===void 0)for(let t=1;t<=te.value;t++)e[t]=!1;else{const t=typeof a.events=="function"?a.events:l=>a.events.includes(l);for(let l=1;l<=te.value;l++){const o=j.value+"/"+ue(l);e[l]=t(o)===!0&&Dt.value(o)}}return e}),bt=s(()=>{let e,t;const{year:l,month:o}=d.value;if(a.calendar!=="persian")e=new Date(l,o-1,1),t=new Date(l,o-1,0).getDate();else{const n=lt(l,o,1);e=new Date(n.gy,n.gm-1,n.gd);let b=o-1,i=l;b===0&&(b=12,i--),t=Oe(i,b)}return{days:e.getDay()-Pe.value-1,endDay:t}}),We=s(()=>{const e=[],{days:t,endDay:l}=bt.value,o=t<0?t+7:t;if(o<6)for(let i=l-o;i<=l;i++)e.push({i,fill:!0});const n=e.length;for(let i=1;i<=te.value;i++){const g={i,event:xt.value[i],classes:[]};_t.value[i]===!0&&(g.in=!0,g.flat=!0),e.push(g)}if(Ce.value[j.value]!==void 0&&Ce.value[j.value].forEach(i=>{const g=n+i-1;Object.assign(e[g],{selected:!0,unelevated:!0,flat:!1,color:U.value,textColor:X.value})}),Ue.value[j.value]!==void 0&&Ue.value[j.value].forEach(i=>{if(i.from!==void 0){const g=n+i.from-1,S=n+(i.to||te.value)-1;for(let xe=g;xe<=S;xe++)Object.assign(e[xe],{range:i.range,unelevated:!0,color:U.value,textColor:X.value});Object.assign(e[g],{rangeFrom:!0,flat:!1}),i.to!==void 0&&Object.assign(e[S],{rangeTo:!0,flat:!1})}else if(i.to!==void 0){const g=n+i.to-1;for(let S=n;S<=g;S++)Object.assign(e[S],{range:i.range,unelevated:!0,color:U.value,textColor:X.value});Object.assign(e[g],{flat:!1,rangeTo:!0})}else{const g=n+te.value-1;for(let S=n;S<=g;S++)Object.assign(e[S],{range:i.range,unelevated:!0,color:U.value,textColor:X.value})}}),_e.value!==void 0){const i=n+_e.value.from-1,g=n+_e.value.to-1;for(let S=i;S<=g;S++)e[S].color=U.value,e[S].editRange=!0;_e.value.includeFrom===!0&&(e[i].editRangeFrom=!0),_e.value.includeTo===!0&&(e[g].editRangeTo=!0)}d.value.year===q.value.year&&d.value.month===q.value.month&&(e[n+q.value.day-1].today=!0);const b=e.length%7;if(b>0){const i=7-b;for(let g=1;g<=i;g++)e.push({i:g,fill:!0})}return e.forEach(i=>{let g="q-date__calendar-item ";i.fill===!0?g+="q-date__calendar-item--fill":(g+=`q-date__calendar-item--${i.in===!0?"in":"out"}`,i.range!==void 0&&(g+=` q-date__range${i.rangeTo===!0?"-to":i.rangeFrom===!0?"-from":""}`),i.editRange===!0&&(g+=` q-date__edit-range${i.editRangeFrom===!0?"-from":""}${i.editRangeTo===!0?"-to":""}`),(i.range!==void 0||i.editRange===!0)&&(g+=` text-${i.color}`)),i.classes=g}),e}),pt=s(()=>a.disable===!0?{"aria-disabled":"true"}:a.readonly===!0?{"aria-readonly":"true"}:{});K(()=>a.modelValue,e=>{if(A===e)A=0;else{const t=Xe(z.value,D.value);fe(t.year,t.month,t)}}),K(V,()=>{$.value!==null&&h.$el.contains(document.activeElement)===!0&&$.value.focus()}),K(()=>d.value.year+"|"+d.value.month,()=>{r("navigation",{year:d.value.year,month:d.value.month})}),K(Me,e=>{at(e,D.value,"mask"),z.value=e}),K($e,e=>{at(z.value,e,"locale"),D.value=e});function Ke(){const e=q.value,t=Ce.value[le(e)];(t===void 0||t.includes(e.day)===!1)&&Ee(e),He(e.year,e.month)}function wt(e){ot(e)===!0&&(V.value=e)}function Mt(e,t){["month","year"].includes(e)&&(e==="month"?Ze:Te)(t===!0?-1:1)}function He(e,t){V.value="Calendar",fe(e,t)}function St(e,t){if(a.range===!1||!e){R.value=null;return}const l=Object.assign({...d.value},e),o=t!==void 0?Object.assign({...d.value},t):l;R.value={init:l,initHash:ae(l),final:o,finalHash:ae(o)},He(l.year,l.month)}function Je(){return a.calendar==="persian"?"YYYY/MM/DD":a.mask}function Re(e,t,l){return Rt(e,t,l,a.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Xe(e,t){const l=Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue?[a.modelValue]:[];if(l.length===0)return Ge();const o=l[l.length-1],n=Re(o.from!==void 0?o.from:o,e,t);return n.dateHash===null?Ge():n}function Ge(){let e,t;if(a.defaultYearMonth!==void 0){const l=a.defaultYearMonth.split("/");e=parseInt(l[0],10),t=parseInt(l[1],10)}else{const l=q.value!==void 0?q.value:Y();e=l.year,t=l.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+ue(t)+"/01"}}function Ze(e){let t=d.value.year,l=Number(d.value.month)+e;l===13?(l=1,t++):l===0&&(l=12,t--),fe(t,l),ee.value===!0&&ke("month")}function Te(e){const t=Number(d.value.year)+e;fe(t,d.value.month),ee.value===!0&&ke("year")}function qt(e){fe(e,d.value.month),V.value=a.defaultView==="Years"?"Months":"Calendar",ee.value===!0&&ke("year")}function Ct(e){fe(d.value.year,e),V.value="Calendar",ee.value===!0&&ke("month")}function kt(e,t){const l=Ce.value[t];(l!==void 0&&l.includes(e.day)===!0?Fe:Ee)(e)}function oe(e){return{year:e.year,month:e.month,day:e.day}}function fe(e,t,l){if(N.value!==null&&e<=N.value.year&&(e=N.value.year,t<N.value.month&&(t=N.value.month)),O.value!==null&&e>=O.value.year&&(e=O.value.year,t>O.value.month&&(t=O.value.month)),l!==void 0){const{hour:n,minute:b,second:i,millisecond:g,timezoneOffset:S,timeHash:xe}=l;Object.assign(d.value,{hour:n,minute:b,second:i,millisecond:g,timezoneOffset:S,timeHash:xe})}const o=e+"/"+ue(t)+"/01";o!==d.value.dateHash&&(J.value=d.value.dateHash<o==(y.lang.rtl!==!0)?"left":"right",e!==d.value.year&&(ce.value=J.value),ie(()=>{E.value=e-e%re-(e<0?re:0),Object.assign(d.value,{year:e,month:t,day:1,dateHash:o})}))}function et(e,t,l){const o=e!==null&&e.length===1&&a.multiple===!1?e[0]:e;A=o;const{reason:n,details:b}=tt(t,l);r("update:modelValue",o,n,b)}function ke(e){const t=u.value[0]!==void 0&&u.value[0].dateHash!==null?{...u.value[0]}:{...d.value};ie(()=>{t.year=d.value.year,t.month=d.value.month;const l=a.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Oe(t.year,t.month);t.day=Math.min(Math.max(1,t.day),l);const o=ge(t);A=o;const{details:n}=tt("",t);r("update:modelValue",o,e,n)})}function tt(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...oe(t.target),from:oe(t.from),to:oe(t.to)}}:{reason:`${e}-day`,details:oe(t)}}function ge(e,t,l){return e.from!==void 0?{from:me.value(e.from,t,l),to:me.value(e.to,t,l)}:me.value(e,t,l)}function Ee(e){let t;if(a.multiple===!0)if(e.from!==void 0){const l=ae(e.from),o=ae(e.to),n=u.value.filter(i=>i.dateHash<l||i.dateHash>o),b=c.value.filter(({from:i,to:g})=>g.dateHash<l||i.dateHash>o);t=n.concat(b).concat(e).map(i=>ge(i))}else{const l=ve.value.slice();l.push(ge(e)),t=l}else t=ge(e);et(t,"add",e)}function Fe(e){if(a.noUnset===!0)return;let t=null;if(a.multiple===!0&&Array.isArray(a.modelValue)===!0){const l=ge(e);e.from!==void 0?t=a.modelValue.filter(o=>o.from!==void 0?o.from!==l.from&&o.to!==l.to:!0):t=a.modelValue.filter(o=>o!==l),t.length===0&&(t=null)}et(t,"remove",e)}function at(e,t,l){const o=u.value.concat(c.value).map(n=>ge(n,e,t)).filter(n=>n.from!==void 0?n.from.dateHash!==null&&n.to.dateHash!==null:n.dateHash!==null);r("update:modelValue",(a.multiple===!0?o:o[0])||null,l)}function Yt(){if(a.minimal!==!0)return v("div",{class:"q-date__header "+I.value},[v("div",{class:"relative-position"},[v(be,{name:"q-transition--fade"},()=>v("div",{key:"h-yr-"+ze.value,class:"q-date__header-subtitle q-date__header-link "+(V.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:p.value,...m("vY",{onClick(){V.value="Years"},onKeyup(e){e.keyCode===13&&(V.value="Years")}})},[ze.value]))]),v("div",{class:"q-date__header-title relative-position flex no-wrap"},[v("div",{class:"relative-position col"},[v(be,{name:"q-transition--fade"},()=>v("div",{key:"h-sub"+Qe.value,class:"q-date__header-title-label q-date__header-link "+(V.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:p.value,...m("vC",{onClick(){V.value="Calendar"},onKeyup(e){e.keyCode===13&&(V.value="Calendar")}})},[Qe.value]))]),a.todayBtn===!0?v(L,{class:"q-date__header-today self-start",icon:y.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:p.value,onClick:Ke}):null])])}function Ne({label:e,type:t,key:l,dir:o,goTo:n,boundaries:b,cls:i}){return[v("div",{class:"row items-center q-date__arrow"},[v(L,{round:!0,dense:!0,size:"sm",flat:!0,icon:qe.value[0],tabindex:p.value,disable:b.prev===!1,...m("go-#"+t,{onClick(){n(-1)}})})]),v("div",{class:"relative-position overflow-hidden flex flex-center"+i},[v(be,{name:"q-transition--jump-"+o},()=>v("div",{key:l},[v(L,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:p.value,...m("view#"+t,{onClick:()=>{V.value=t}})})]))]),v("div",{class:"row items-center q-date__arrow"},[v(L,{round:!0,dense:!0,size:"sm",flat:!0,icon:qe.value[1],tabindex:p.value,disable:b.next===!1,...m("go+#"+t,{onClick(){n(1)}})})])]}const It={Calendar:()=>[v("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[v("div",{class:"q-date__navigation row items-center no-wrap"},Ne({label:D.value.months[d.value.month-1],type:"Months",key:d.value.month,dir:J.value,goTo:Ze,boundaries:Be.value.month,cls:" col"}).concat(Ne({label:d.value.year,type:"Years",key:d.value.year,dir:ce.value,goTo:Te,boundaries:Be.value.year,cls:""}))),v("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},yt.value.map(e=>v("div",{class:"q-date__calendar-item"},[v("div",e)]))),v("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[v(be,{name:"q-transition--slide-"+J.value},()=>v("div",{key:j.value,class:"q-date__calendar-days fit"},We.value.map(e=>v("div",{class:e.classes},[e.in===!0?v(L,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:p.value,...m("day#"+e.i,{onClick:()=>{Vt(e.i)},onMouseover:()=>{$t(e.i)}})},e.event!==!1?()=>v("div",{class:"q-date__event bg-"+e.event}):null):v("div",""+e.i)]))))])])],Months(){const e=d.value.year===q.value.year,t=o=>N.value!==null&&d.value.year===N.value.year&&N.value.month>o||O.value!==null&&d.value.year===O.value.year&&O.value.month<o,l=D.value.monthsShort.map((o,n)=>{const b=d.value.month===n+1;return v("div",{class:"q-date__months-item flex flex-center"},[v(L,{class:e===!0&&q.value.month===n+1?"q-date__today":null,flat:b!==!0,label:o,unelevated:b,color:b===!0?U.value:null,textColor:b===!0?X.value:null,tabindex:p.value,disable:t(n+1),...m("month#"+n,{onClick:()=>{Ct(n+1)}})})])});return a.yearsInMonthView===!0&&l.unshift(v("div",{class:"row no-wrap full-width"},[Ne({label:d.value.year,type:"Years",key:d.value.year,dir:ce.value,goTo:Te,boundaries:Be.value.year,cls:" col"})])),v("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},l)},Years(){const e=E.value,t=e+re,l=[],o=n=>N.value!==null&&N.value.year>n||O.value!==null&&O.value.year<n;for(let n=e;n<=t;n++){const b=d.value.year===n;l.push(v("div",{class:"q-date__years-item flex flex-center"},[v(L,{key:"yr"+n,class:q.value.year===n?"q-date__today":null,flat:!b,label:n,dense:!0,unelevated:b,color:b===!0?U.value:null,textColor:b===!0?X.value:null,tabindex:p.value,disable:o(n),...m("yr#"+n,{onClick:()=>{qt(n)}})})]))}return v("div",{class:"q-date__view q-date__years flex flex-center"},[v("div",{class:"col-auto"},[v(L,{round:!0,dense:!0,flat:!0,icon:qe.value[0],tabindex:p.value,disable:o(e),...m("y-",{onClick:()=>{E.value-=re}})})]),v("div",{class:"q-date__years-content col self-stretch row items-center"},l),v("div",{class:"col-auto"},[v(L,{round:!0,dense:!0,flat:!0,icon:qe.value[1],tabindex:p.value,disable:o(t),...m("y+",{onClick:()=>{E.value+=re}})})])])}};function Vt(e){const t={...d.value,day:e};if(a.range===!1){kt(t,j.value);return}if(R.value===null){const l=We.value.find(n=>n.fill!==!0&&n.i===e);if(a.noUnset!==!0&&l.range!==void 0){Fe({target:t,from:l.range.from,to:l.range.to});return}if(l.selected===!0){Fe(t);return}const o=ae(t);R.value={init:t,initHash:o,final:t,finalHash:o},r("rangeStart",oe(t))}else{const l=R.value.initHash,o=ae(t),n=l<=o?{from:R.value.init,to:t}:{from:t,to:R.value.init};R.value=null,Ee(l===o?t:{target:t,...n}),r("rangeEnd",{from:oe(n.from),to:oe(n.to)})}}function $t(e){if(R.value!==null){const t={...d.value,day:e};Object.assign(R.value,{final:t,finalHash:ae(t)})}}return Object.assign(h,{setToday:Ke,setView:wt,offsetCalendar:Mt,setCalendarTo:He,setEditingRange:St}),()=>{const e=[v("div",{class:"q-date__content col relative-position"},[v(be,{name:"q-transition--fade"},It[V.value])])],t=Ht(w.default);return t!==void 0&&e.push(v("div",{class:"q-date__actions"},t)),a.name!==void 0&&a.disable!==!0&&B(e,"push"),v("div",{class:Se.value,...pt.value},[Yt(),v("div",{ref:$,class:"q-date__main col column",tabindex:-1},e)])}}});const va={class:"segmented-control"},ma=["id","name","value"],fa=["for"],ft={__name:"SegmentedControl",props:{modelValue:{required:!0,type:[Number,String],default:"0"},segments:{required:!0,type:Array},elementName:{type:String,required:!0}},emits:["update:modelValue"],setup(a,{emit:w}){const r=a,h=s({get:()=>r.modelValue,set:I=>{w("update:modelValue",I)}}),y=M(0),k=s(()=>r.segments.findIndex(I=>I.id===r.modelValue)),m=s(()=>`transform:translateX(${y.value*k.value}px)`),p=()=>{ie(()=>{const I=document.querySelector(`input[type='radio'][value='${r.modelValue}'][name='${r.elementName}']`);y.value=I&&I.offsetWidth})};return Nt(()=>{p(),r.modelValue,r.segments}),Ot(()=>{window.addEventListener("resize",p)}),At(()=>{window.removeEventListener("resize",p)}),(I,H)=>(C(),T("div",va,[Z("span",{class:"selection-pill",style:jt(m.value)},null,4),(C(!0),T(Ye,null,Ie(a.segments,Y=>(C(),T("div",{key:Y.id,class:"option"},[Lt(Z("input",{type:"radio",id:Y.id,name:a.elementName,value:Y.id,"onUpdate:modelValue":H[0]||(H[0]=A=>h.value=A)},null,8,ma),[[Qt,h.value]]),Z("label",{for:Y.id},[Z("span",null,G(Y.title),1)],8,fa)]))),128))]))}},ga={xs:2,sm:4,md:6,lg:10,xl:14};function st(a,w,r){return{transform:w===!0?`translateX(${r.lang.rtl===!0?"-":""}100%) scale3d(${-a},1,1)`:`scale3d(${a},1,1)`}}var ha=it({name:"QLinearProgress",props:{...ct,...zt,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(a,{slots:w}){const{proxy:r}=dt(),h=vt(a,r.$q),y=Pt(a,ga),k=s(()=>a.indeterminate===!0||a.query===!0),m=s(()=>a.reverse!==a.query),p=s(()=>({...y.value!==null?y.value:{},"--q-linear-progress-speed":`${a.animationSpeed}ms`})),I=s(()=>"q-linear-progress"+(a.color!==void 0?` text-${a.color}`:"")+(a.reverse===!0||a.query===!0?" q-linear-progress--reverse":"")+(a.rounded===!0?" rounded-borders":"")),H=s(()=>st(a.buffer!==void 0?a.buffer:1,m.value,r.$q)),Y=s(()=>`with${a.instantFeedback===!0?"out":""}-transition`),A=s(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${Y.value} q-linear-progress__track--${h.value===!0?"dark":"light"}`+(a.trackColor!==void 0?` bg-${a.trackColor}`:"")),P=s(()=>st(k.value===!0?1:a.value,m.value,r.$q)),B=s(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${Y.value} q-linear-progress__model--${k.value===!0?"in":""}determinate`),$=s(()=>({width:`${a.value*100}%`})),z=s(()=>`q-linear-progress__stripe absolute-${a.reverse===!0?"right":"left"} q-linear-progress__stripe--${Y.value}`);return()=>{const D=[v("div",{class:A.value,style:H.value}),v("div",{class:B.value,style:P.value})];return a.stripe===!0&&k.value===!1&&D.push(v("div",{class:z.value,style:$.value})),v("div",{class:I.value,style:p.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":a.indeterminate===!0?void 0:a.value},Ut(w.default,D))}}});const ya={key:1},Da={key:2,class:"bg-surface q-px-md q-py-md rounded-borders-14",flat:""},_a={key:0},xa={key:1},ba={key:0},pa={key:0},wa={key:1},Ma={key:1},Sa="Your unsatisfied needs sorted from highest to lowest unsatisfaction impact.",qa="Your satisfied needs sorted from highest to lowest satisfaction impact.",Ca="Your needs sorted from most to less important.",ut={__name:"LearnCardNeeds",props:{flag:{type:String,default:"satisfaction"},dateRange:{type:String,default:()=>{new Date().getFullYear().toString()}},segControl:{type:Boolean,default:!1},secondSegSelected:{type:Boolean,default:!1},learnCardExpanded:{type:Boolean,default:!1}},emits:["click:segmentedControl","click:showButton","ready:aggregateData"],setup(a,{emit:w}){const r=a,h=je(),y=s(()=>r.flag=="satisfaction"?r.secondSegSelected?"satisfaction":"unsatisfaction":"importance");let k=oa();const m=M([{title:"Unsatisfied",id:"unsatisfied"+k},{title:"Satisfied",id:"satisfied"+k}]),p=s(()=>r.secondSegSelected?"satisfied"+k:"unsatisfied"+k),I="segStats"+k;K(()=>h.aggregateData&&h.aggregateData[r.dateRange]&&h.aggregateData[r.dateRange][y.value],(P,B)=>{P&&P.length>0&&w("ready:aggregateData",{flag:r.flag})},{immediate:!0});const H=s(()=>r.learnCardExpanded?h.aggregateData[r.dateRange][y.value].length:5),Y=()=>{r.secondSegSelected?w("click:segmentedControl",{value:!1,flag:r.flag}):w("click:segmentedControl",{value:!0,flag:r.flag})},A=()=>{r.learnCardExpanded?w("click:showButton",{value:!1,flag:r.flag}):w("click:showButton",{value:!0,flag:r.flag})};return(P,B)=>(C(),de(Le,{class:"bg-surface q-px-md q-pt-md q-pb-sm q-mb-lg rounded-borders-14",flat:""},{default:x(()=>[r.segControl?(C(),de(ft,{key:0,style:{"margin-bottom":"8px"},modelValue:p.value,"onUpdate:modelValue":B[0]||(B[0]=$=>Y($)),segments:m.value,"element-name":I},null,8,["modelValue","segments"])):Ve("",!0),W(h).aggregateData&&W(h).aggregateData[r.dateRange]&&W(h).aggregateData[r.dateRange][y.value].length>0?(C(),T("div",ya,[_(Le,{class:"bg-primary-container",style:{"border-radius":"8px"},flat:""},{default:x(()=>[_(pe,{class:"q-px-md"},{default:x(()=>[_(se,{side:""},{default:x(()=>[_(Wt,{name:"o_info",color:"primary",size:"32px"})]),_:1}),_(se,null,{default:x(()=>[_(we,null,{default:x(()=>[Q(G(r.flag=="satisfaction"?r.secondSegSelected?qa:Sa:Ca),1)]),_:1})]),_:1})]),_:1})]),_:1}),_(Zt,{class:"q-mt-xs"},{default:x(()=>[_(Kt,{appear:"","enter-active-class":"meala","leave-active-class":"meala la","move-class":"meala","enter-from-class":"eflt","leave-to-class":"eflt"},{default:x(()=>[(C(!0),T(Ye,null,Ie(W(h).aggregateData[r.dateRange][y.value].slice(0,H.value),$=>(C(),de(pe,{key:$.needName,class:"q-pt-sm q-pb-sm q-px-xs",clickable:""},{default:x(()=>[_(se,{avatar:"",class:"q-pr-none"},{default:x(()=>[_(Jt,{square:"","font-size":"35px"},{default:x(()=>[Q(G(W(h).needsMap[$.needName]),1)]),_:2},1024)]),_:2},1024),_(se,null,{default:x(()=>[_(pe,{class:"q-px-xs",dense:"",style:{"min-height":"0px"}},{default:x(()=>[_(se,null,{default:x(()=>[_(we,null,{default:x(()=>[Q(G($.needName),1)]),_:2},1024),_(we,{caption:"",lines:"1"},{default:x(()=>[Q(G($.occurrenceCount)+" "+G($.occurrenceCount==1?"moment":"moments"),1)]),_:2},1024)]),_:2},1024),_(se,{side:""},{default:x(()=>[Q(G(parseFloat(($[r.flag=="satisfaction"?r.secondSegSelected?"satisfactionImpactLabelValue":"unsatisfactionImpactLabelValue":"importanceValue"]*100).toFixed(0))+"%"),1)]),_:2},1024)]),_:2},1024),_(pe,{class:"q-px-xs q-pt-none",dense:"",style:{"min-height":"0px"}},{default:x(()=>[_(ha,{value:$[r.flag=="satisfaction"?r.secondSegSelected?"satisfactionImpactDisplayValue":"unsatisfactionImpactDisplayValue":"importanceDisplayValue"],buffer:$.importanceDisplayValue,color:r.flag=="satisfaction"?r.secondSegSelected?"green":"red":"blue","track-color":"grey",reverse:r.secondSegSelected,class:"q-mt-sm",rounded:"","animation-speed":"500"},null,8,["value","buffer","color","reverse"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):(C(),T("div",Da,[!W(h)||!W(h).hasNeeds?(C(),T("div",_a," Add Moments in the Home tab to learn more about your needs! ")):(C(),T("div",xa,[r.flag=="satisfaction"?(C(),T("div",ba,[r.secondSegSelected?(C(),T("div",pa," No satisfied needs for this period. ")):(C(),T("div",wa," No unsatisfied needs for this period "))])):(C(),T("div",Ma," No needs for this period "))]))])),W(h).aggregateData&&W(h).aggregateData[r.dateRange]&&W(h).aggregateData[r.dateRange][y.value].length>5?(C(),de(mt,{key:3,align:"center"},{default:x(()=>[_(L,{color:"primary",onClick:A,class:"q-mx-sm q-mt-sm full-width","no-caps":"",flat:""},{default:x(()=>[Q(G(r.learnCardExpanded?"Show less":"Show more"),1)]),_:1})]),_:1})):Ve("",!0)]),_:1}))}};const ka={key:0},Ya={class:"q-px-md"},Oa=Object.assign({preFetch(){const a=je();return console.log("In LearnTab preFetch"),a.fetchAggregateData()}},{__name:"LearnTabV1",setup(a){const w=je(),r=M("This month"),h=M(null),y=M(null),k=M(!1),m=M(0);Xt(()=>{console.log("ONACTIVATED"),k.value||(h.value.initialize(),y.value.initialize(),h.value.swiper.activeIndex=m.value,y.value.swiper.activeIndex=m.value,h.value.swiper.slideTo(m.value,0),y.value.swiper.slideTo(m.value,0),k.value=!0)}),Gt(()=>{console.log("ONDEACTIVATED"),k.value=!1}),K(m,(u,c)=>{k.value&&(console.log("in activeIndex watcher, a 1 sec delay"),setTimeout(function(){h.value.swiper.activeIndex=u,y.value.swiper.activeIndex=u,h.value.swiper.slideTo(u,300),y.value.swiper.slideTo(u,300),console.log("in activeIndex watcher, activeIndex changed from",c,"to",u),console.log("CHECK IMPORTANCE",y.value.swiper)},1))});const p=M(!1),I=({value:u,flag:c})=>{c==="satisfaction"&&(p.value=u)},H=M(!1),Y=M(!1),A=({value:u,flag:c})=>{c==="satisfaction"?(H.value=u,ie(()=>{h.value.swiper.updateAutoHeight(300)})):(Y.value=u,ie(()=>{y.value.swiper.updateAutoHeight(300)}))},P=({flag:u})=>{k.value&&(u==="satisfaction"?ie(()=>{h.value.swiper.updateAutoHeight(300)}):ie(()=>{y.value.swiper.updateAutoHeight(300)}))},B=s(()=>new Date),$=s(()=>F.formatDate(B.value,"YYYY/MM")),z=s(()=>`${B.value.getFullYear()}-${(B.value.getMonth()+1).toString().padStart(2,"0")}`),D=s(()=>{var u;return(u=w.oldestMomentDate)!=null?u:B.value}),Me=s(()=>F.formatDate(D.value,"YYYY/MM")),$e=M([{title:"Monthly",id:"Monthly"},{title:"Yearly",id:"Yearly"}]),q=M("Monthly"),d=s(()=>{const u=[],c=F.getDateDiff(B.value,D.value,"years");for(let f=c;f>=0;f--)u.push((B.value.getFullYear()-f).toString());return console.log("in computed dateRangesYears, dateRanges is",u),u});K(d,u=>{m.value=u.length-1,console.log("in watch dateRangesYears updated activeIndex to",m.value)},{immediate:!0});const V=s(()=>{const u=[],c=F.getDateDiff(B.value,D.value,"months");let f=F.startOfDate(D.value,"month");for(let me=0;me<=c;me++)u.push(`${f.getFullYear()}-${(f.getMonth()+1).toString().padStart(2,"0")}`),f=F.addToDate(f,{months:1});return console.log("in computed dateRangesMonths, dateRanges is",u),u});K(V,u=>{m.value=u.length-1,console.log("in watch dateRangesMonths updated activeIndex to",m.value)},{immediate:!0});const ne=u=>{console.log("in dateRangesMonthsIdxToDate, idx",u,"dateRangesMonths.value[idx]",V.value[u]);const[c,f]=V.value[u].split("-");return new Date(Number(c),Number(f)-1)},J=M(!1),ce=M("date"),ye=u=>{ce.value=u,J.value=!0},E=M(F.formatDate(B.value,"YYYY/MM/DD")),R=M(Date.now()),Se=M(Date.now()),U=u=>u>=D.value,X=()=>{console.log("in updateDateButtonLabel, activeIndex.value",m.value),q.value==="Yearly"?r.value=B.value.getFullYear()==d.value[m.value]?"This year":d.value[m.value].toString():q.value==="Monthly"&&(z.value==V.value[m.value]?r.value="This month":r.value=ne(m.value).getFullYear()===B.value.getFullYear()?F.formatDate(ne(m.value),"MMMM"):F.formatDate(ne(m.value),"MMMM YYYY"))},ee=u=>{console.log("onUpdatePickedDate newVal",u),u&&(q.value==="Monthly"?(R.value=Date.now(),m.value=F.getDateDiff(u,D.value,"months")):q.value==="Yearly"&&(Se.value=Date.now(),m.value=F.getDateDiff(u,D.value,"years")),console.log("onUpdatePickedDate triggered currentSlide update to",m.value,"because newVal",u,"and oldestMomentDate.value",D.value,"and segDateId.value",q.value),X())};K(q,(u,c)=>{if(console.log("watch(segDateId) triggered with newVal",u,"pickedDateYYYYsMMsDD.value",E.value,"oldestMomentDate.value",D.value),u){let f=F.getMaxDate(E.value,D.value);E.value=F.formatDate(f,"YYYY/MM/DD"),console.log("watch(segDateId) changed pickedDateYYYYsMMsDD.value to",E.value),ee(E.value)}});const ve=(u,c)=>{console.log("SWIPER activeIndexChange fired with flag",c,", from previousIndex",u.detail[0].previousIndex,"to activeIndex",u.detail[0].activeIndex),m.value=c==="importance"?y.value.swiper.activeIndex:h.value.swiper.activeIndex,console.log("In onActiveIndexChangeBySwiper with flag",c," activeIndex updated to ",m.value),X(),q.value==="Monthly"?E.value=F.formatDate(ne(m.value),"YYYY/MM/DD"):q.value==="Yearly"&&(E.value=F.formatDate(d.value[m.value],"YYYY/MM/DD"))};return(u,c)=>(C(),de(na,{class:"q-mx-auto q-pa-md",style:{"max-width":"600px"}},{default:x(()=>[_(pe,{class:"q-px-none q-pt-none"},{default:x(()=>[_(se,{class:"col-auto"},{default:x(()=>[_(L,{unelevated:"",rounded:"",class:"text-subtitle1 bg-button-on-background text-on-background",icon:"calendar_today","no-caps":"",onClick:c[0]||(c[0]=f=>ye("date"))},{default:x(()=>[Q(G(r.value),1)]),_:1})]),_:1})]),_:1}),Z("div",null,[_(we,{class:"text-body1 text-weight-medium q-my-sm"},{default:x(()=>[Q("Needs Satisfaction")]),_:1}),Z("swiper-container",{ref_key:"swiperElSatisfaction",ref:h,init:"false","auto-height":"true",observer:"true","observe-slide-children":"true","grab-cursor":"true","pagination-dynamic-bullets":"true",onActiveindexchange:c[1]||(c[1]=f=>ve(f,"satisfaction"))},[(C(!0),T(Ye,null,Ie(q.value==="Monthly"?V.value:d.value,f=>(C(),T("swiper-slide",{key:f},[_(ut,{flag:"satisfaction","date-range":f,"second-seg-selected":p.value,"learn-card-expanded":H.value,"seg-control":"","onClick:segmentedControl":I,"onClick:showButton":A,"onReady:aggregateData":P},null,8,["date-range","second-seg-selected","learn-card-expanded"])]))),128))],544)]),Z("div",null,[_(we,{class:"text-body1 text-weight-medium q-my-sm"},{default:x(()=>[Q("Needs Importance")]),_:1}),Z("swiper-container",{ref_key:"swiperElImportance",ref:y,init:"false","auto-height":"true",observer:"true","observe-slide-children":"true","grab-cursor":"true","pagination-dynamic-bullets":"true",onActiveindexchange:c[2]||(c[2]=f=>ve(f,"importance")),onObserverupdate:c[3]||(c[3]=f=>console.log("SWIPER observerUpdate fired")),onUpdate:c[4]||(c[4]=f=>console.log("SWIPER update fired")),onBeforedestroy:c[5]||(c[5]=f=>console.log("SWIPER beforeDestroy fired")),onDestroy:c[6]||(c[6]=f=>console.log("SWIPER destroy fired")),onInit:c[7]||(c[7]=f=>console.log("SWIPER init fired"))},[(C(!0),T(Ye,null,Ie(q.value==="Monthly"?V.value:d.value,f=>(C(),T("swiper-slide",{key:f},[_(ut,{flag:"importance","date-range":f,"learn-card-expanded":Y.value,"onClick:showButton":A,"onReady:aggregateData":P},null,8,["date-range","learn-card-expanded"])]))),128))],544)]),_(ea,{modelValue:J.value,"onUpdate:modelValue":c[12]||(c[12]=f=>J.value=f),position:"bottom"},{default:x(()=>[_(Le,{class:"bg-background q-px-sm"},{default:x(()=>[ce.value==="date"?(C(),T("div",ka,[_(nt,{class:"text-h5 text-weight-medium"},{default:x(()=>[Q("Filter period ")]),_:1}),_(nt,{class:"q-pt-xs text-outline"},{default:x(()=>[Q("Filtering the period will take into account only the moments that happened during the selected period. ")]),_:1}),Z("div",Ya,[_(ft,{modelValue:q.value,"onUpdate:modelValue":c[8]||(c[8]=f=>q.value=f),segments:$e.value,"element-name":"LearnTabSegDate"},null,8,["modelValue","segments"])]),q.value==="Monthly"?(C(),de(rt,{modelValue:E.value,"onUpdate:modelValue":[c[9]||(c[9]=f=>E.value=f),ee],options:U,"navigation-min-year-month":Me.value,"navigation-max-year-month":$.value,"default-view":"Months",class:"full-width q-mt-sm q-mx-lg q-px-xl bg-surface text-on-surface",flat:"",minimal:"","years-in-month-view":"","emit-immediately":"",key:R.value},null,8,["modelValue","navigation-min-year-month","navigation-max-year-month"])):q.value==="Yearly"?(C(),de(rt,{modelValue:E.value,"onUpdate:modelValue":[c[10]||(c[10]=f=>E.value=f),ee],options:U,"navigation-min-year-month":Me.value,"navigation-max-year-month":$.value,"default-view":"Years",class:"full-width q-mt-sm q-mx-lg q-px-xl bg-surface text-on-surface",flat:"",minimal:"","emit-immediately":"",key:Se.value},null,8,["modelValue","navigation-min-year-month","navigation-max-year-month"])):Ve("",!0)])):Ve("",!0),_(mt,{align:"center"},{default:x(()=>[_(L,{rounded:"",color:"primary",onClick:c[11]||(c[11]=f=>J.value=!1),padding:"10px",class:"text-body1 q-ma-sm full-width","no-caps":""},{default:x(()=>[Q("Done")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Oa as default};
